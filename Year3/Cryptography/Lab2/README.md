# Cryptography Text Analysis Laboratory

## Overview
This laboratory project focuses on analyzing and decrypting text using frequency analysis and letter substitution techniques. It provides tools for reading encrypted text, performing letter substitutions, analyzing letter frequencies, and visualizing the results.

## Features
- Read encrypted text from a file
- Perform letter substitutions to decrypt the text
- Analyze letter frequencies in the text
- Compare frequency distribution with standard English language letter frequencies
- Visualize letter frequency distributions
- Write decrypted text to a file
- Streamlit interface to interact with the decryption process using a web-based UI.
## Tools
- `Streamlit App`: Provides a graphical interface for real-time interaction with text decryption and frequency analysis.
- `Command Line`: Use Python scripts (main.py and streamlit.py) for frequency analysis and letter substitution via the terminal.

## Files
- `main.py`: The main script that orchestrates the decryption process
- `utils.py`: Utility functions for text analysis, file operations, and visualization
- `streamlit.py`:  Streamlit-based graphical interface for decryption and analysis.

## Streamlit interface
The Streamlit app provides a user-friendly way to interact with the decryption tools:

- *Load Encrypted Text:* Upload an encrypted text file for analysis.
- *View Letter Frequency Analysis:* Automatically generate a frequency plot of letters in the ciphertext.
- *Perform Letter Substitutions:* Enter letter substitutions directly in the app to decrypt the text step-by-step.
- *Compare with English Frequencies:* Visualize how the letter distribution compares to standard English letter frequencies.
- *Save Decrypted Text:* After successful decryption, save the result to a file.

## How to Run the Streamlit App
The Streamlit app provides a user-friendly way to interact with the decryption tools:

- Install the required dependencies (including Streamlit and Matplotlib).
- Run the Streamlit app by executing the following command:
```python
streamlit run streamlit.py
```

- Use the web interface to upload encrypted text, perform letter substitutions, and visualize results.

## Usage
1. Ensure you have the required dependencies installed (matplotlib).
2. Place your encrypted text in a file named `encrypted.txt`.
3. Run the `main.py` script:

##  Example of a Frequency Analysis Attack
We intercepted a ciphertext c, which we know was obtained using a monoalphabetic cipher on a message written in English:

- IVTSZNGW rtp dgovi pxvjv. Wqv infts tizf, dgovi Qvgif XX nc Andiang,Uixghv nc Hngov, qto xgkvpwvo xw tw otrg Rvogvpotf, Tuixs 19, 1628. Adwwqv Qdjdvgnwp, xgpxov wqv atwwsvzvgwp nc wqv sxwwsv wnrg xg pndwqvigCitghv, rviv udwwxgj du t pwxcc ovcvgpv. Wqvf htggngtovo Hngov cinz twnrvi tgo hngwvzuwdndpsf ivevhwvo qxp ovztgop wqtw wqvf pdiivgovi,ptfxgj wqtw wqvf rndso oxv xgpwvto. Hngov aindjqw du cxkv axj htggngcinz Tsax, t onmvg zxsvp trtf, tgo ng Pdgotf itgjvo wqvz xg tgnzxgndp sxgv cthxgj Ivtszngw.Wqtw ptzv otf qxp pnsoxvip htuwdivo tg xgqtaxwtgw nc wqv wnrg rqnrtp wifxgj wn htiif tg vghxuqvivo zvpptjv wn Qdjdvgnw cnihvp ndwpxov.Gngv nc Hngov'p zvg hndso dgixoosv xw, adw odixgj wqv rvvl wqv uixghvsvtigvo wqtw xw zxjqw av pnskvo af wqv phxng nc t svtoxgj ctzxsf nc Tsaxrqn rtp lgnrg wn qtkv tg xgwvivpw xg hxuqvip.Hngov pvgw qxz wqv hifuwnjitz. Wqv fndgj ztg pnskvo xw ng wqv punw.Xw ivkvtsvo wqtw wqv Qdjdvgnwp ovpuvitwvsf gvvovo zdgxwxngp tgo wqtw, xcwqvf rviv gnw pduusxvo, wqvf rndso qtkv wn fxvso. Wqxp rtp gvrp xgovvo,cni ovpuxwv wqv ovpwidhwxng nc t gdzavi nc qndpvp af wqv Htwqnsxhatwwvixvp, wqv wnrg rtp hngwxgdxgj wn ivpxpw pwndwsf rxwq gn pxjg ncpdiivgovi. Hngov ivwdigvo wqv hifuwnjitz wn wqv xgqtaxwtgwp, tgo ngPdgotf, Tuixs 30, 1628, wqndjq xwp cniwxcxhtwxngp rviv pwxss dgaivthqvotgo xwp ovcvgpvp pwxss tuutivgwsf tovbdtwv cni t sngj pxvjv, Ivtszngwpdoovgsf tgo dgvyuvhwvosf htuxwdstwvo. Rxwq wqxp oitztwxh pdhhvppavjtg wqv htivvi nc wqv ztg rqn rtp wn avhnzv Citghv'p cxipw cdss-wxzvhifuwnsnjxpw: wqv jivtw Tgwnxgv Inppxjgns.Rqvg rnio nc wqv xghxovgw ivthqvo Htioxgts Ixhqvsxvd, wqv tpwdwv tgotasv Jitf Vzxgvghv nc Citghv, qv tw nghv twwthqvo wqxp dpvcds wtsvgw wnqxp pdxwv. Inppxjgns uinkvo qxp rniwq tsznpw xzzvoxtwvsf. Wqv Htwqnsxhtizxvp dgovi Ixhqvsxvd pdiindgoxgj wqv hqxvc Qdjdvgnw atpwxng nc StInhqvssv xgwvihvuwvo pnzv svwwvip xg hxuqvi, rqxhq wqv fndgj hnovaivtlvinc Tsax ivto rxwq vtpv. Qv wnso Qxp Vzxgvghv wqtw wqv pwtikxgj hxwxmvgprviv vtjvisf trtxwxgj qvsu wqtw wqv Vgjsxpq qto uinzxpvo wn pvgo af pvt. Rqvg wqv csvvwtiixkvo, wqv uixzvo jdtiopqxup tgo cniwp pn xgwxzxotwvo xw wqtw xw pwnnoncc wqv uniw'p vgwitghv tgo ztov gn pvixndp twwvzuw wn cnihv t utpptjv. Tzngwq stwvi, wqv hxwf htuxwdstwvo xg cdss pxjqw nc wqv Vgjsxpq kvppvsp�tgowqv jivtw Civghq witoxwxng nc vyuviwxpv xg hifuwnsnjf qto avvg cndgovo.Inppxjgns kvif bdxhlsf vpwtasxpqvo qxzpvsc xg wqv infts pvikxhv. Af1630, qxp pnsdwxngp qto ztov qxz ixhq vgndjq wn adxso t pztss adwvsvjtgw hqtwvtd tw Edkxpf, 12 zxsvp pndwq nc Utixp, stwvi pdiindgoxgj xwrxwq t hqtizxgj xgcnizts jtiovg ovpxjgvo af Sv Gnwiv, wqv jtiovgvi ncKviptxssvp. Qviv Sndxp YXXX pwnuuvo wn kxpxw wqv fndgj hifuw-tgtsfpw xg1634, 1635 tgo 1636 ng qxp ivwdigp wn Utixp cinz Cngwtxgvasvtd.Xg wqv prtpqadhlsxgj hndiw nc wqtw zngtihq, tgo wqvg xg wqvivpusvgovgw ngv nc Sndxp YXK, Inppxjgns pvikvo rxwq tg vywitnioxgtifcthxsxwf. Wqv pwingjqnso nc Qvpoxg pdiivgovivo t rvvl pnngvi wqtg xwnwqvirxpv rndso qtkv avhtdpv qv pnskvo tg vghxuqvivo usvt cni qvsu, tgowqvg hnzunpvo t ivusf xg wqv ptzv hxuqvi wvssxgj wqv wnrgpuvnusv qnrcdwxsv wqvxi qnuvp rviv. Qnr ztgf nwqvi wnrgp qv hnzuvssvo wnpdiivgovi, qnr ztgf oxusnztwxh hndup qv ztov unppxasv, qnr ztgfavwitftsp qv dghnkvivo tzngj wqv jivtw gnasvp xg wqnpv otfp nc pqxcwxgjtssvjxtghvp, qv gvkvi oxphdppvo. Wqxp ivwxhvghv htdpvo pnzv tw wqv hndiwwn hqtijv wqtw qv gvkvi thwdtssf pnskvo t pxgjsv hxuqvi, tgo wqtw wqvhtioxgts puivto xgcstwvo idznip tandw qxp taxsxwxvp wn oxphnditjv rndso-av hngpuxitwnip. Adw xg cthw Ixhqvsxvd rtp civbdvgwsf wvssxgj qxppdanioxgtwvp pdhq wqxgjp tp,Xw xp gvhvpptif wn ztlv dpv, xg zf nuxgxng,nc wqv svwwvip nc wqv ztg rqn qtp avvg tiivpwvo af wqv hxkxs tdwqnixwxvp twZvmxvivp, wqtw xp wn ptf, qtkv wqvz udw xgwn Inppxjgns'p qtgop wn pvv xcwqviv xp pnzvwqxgj xzuniwtgw xg wqvz. Ni, vxjqw fvtip stwvi, xg 1642,rixwxgj wn Zvppxvdip ov Gnfvip tgo ov Hqtkxjgf:X ptr, xg pnzvvywithwp, wqtw Inppxjgns pvgw zv, t widhv gvjnwxtwxng nc wqv Lxgj ncVgjstgo rxwq wqv Uixghv nc Nitgjv; X on gnw wqxgl wqtw xw htg qtkv tgfvccvhw, adw ... xw xp du wn fnd, jvgwsvzvg, wn lvvu fndi vfvp uvvsvo

The first step was to find the frequencies of all letters appearing in the ciphertext. We used the `find_frequency` function to calculate these frequencies and `plot_frequency`
to get a better understanding of them:

```python
frequency = find_frequency(str)
plot_frequency(frequency, label="Frequency of encrypted text")
plot_frequency(english_language_letters_frequency, label="Frequency of English language")
```
<p float="left">
  <img src="https://github.com/user-attachments/assets/b75a8e5d-a1d8-45fe-9cee-6f319ce76b67" width="47%" />
  <img src="https://github.com/user-attachments/assets/a9262f13-a025-419f-a6d2-2c3cd0fc69db" width="47%" /> 
</p>

After calculating the frequencies, we started making substitutions based on the most common letters in English. We used the `substitute_letters` function for each substitution:

```python
str = substitute_letters(str, 'V', 'e')
str = substitute_letters(str, 'W', 't')
```

We started with the most frequent letters. In our ciphertext, 'V' was very common, so we substituted it with 'e', the most common letter in English. Similarly, 'W' was substituted with 't', the second most common letter in English.
As we made these substitutions, patterns began to emerge. For example, after substituting 'V' with 'e' and 'W' with 't', we might have seen words like "the" starting to form, confirming our guesses.
We continued this process, using our knowledge of English letter frequencies and common words to guide our substitutions. For instance:
- 'Q' was substituted with 'h', as we might have seen "tQe" and guessed it was "the".
- 'T' became 'a', possibly from seeing common words like "Tnd" (and) or "ThTt" (that).
- 'G' was changed to 'n', perhaps from seeing "iG" at the end of words, a common English ending.

```python
str = substitute_letters(str, 'Q', 'h')
str = substitute_letters(str, 'T', 'a')
str = substitute_letters(str, 'G', 'n')
```

After this substitutions our text had started to show more guessable letters, which started obvious substitutions.
- IeaSZNnt RaP DnOeI PXeJe. the INFaS aIZF, DnOeI henIF XX NC ANDIANn,UIXnHe NC HNnOe, haO XnKePteO Xt at OaRn ReOnePOaF, aUIXS 19, 1628. ADtthe hDJDenNtP, XnPXOe the AattSeZentP NC the SXttSe tNRn Xn PNDtheInCIanHe, ReIe UDttXnJ DU a PtXCC OeCenPe. theF HannNnaOeO HNnOe CINZ atNReI anO HNnteZUtDNDPSF IeEeHteO hXP OeZanOP that theF PDIIenOeI,PaFXnJ that theF RNDSO OXe XnPteaO. HNnOe AINDJht DU CXKe AXJ HannNnCINZ aSAX, a ONMen ZXSeP aRaF, anO Nn PDnOaF IanJeO theZ Xn anNZXnNDP SXne CaHXnJ IeaSZNnt.that PaZe OaF hXP PNSOXeIP HaUtDIeO an XnhaAXtant NC the tNRn RhNRaP tIFXnJ tN HaIIF an enHXUheIeO ZePPaJe tN hDJDenNt CNIHeP NDtPXOe.nNne NC HNnOe'P Zen HNDSO DnIXOOSe Xt, ADt ODIXnJ the ReeL the UIXnHeSeaIneO that Xt ZXJht Ae PNSKeO AF the PHXNn NC a SeaOXnJ CaZXSF NC aSAXRhN RaP LnNRn tN haKe an XnteIePt Xn HXUheIP.HNnOe Pent hXZ the HIFUtNJIaZ. the FNDnJ Zan PNSKeO Xt Nn the PUNt.Xt IeKeaSeO that the hDJDenNtP OePUeIateSF neeOeO ZDnXtXNnP anO that, XCtheF ReIe nNt PDUUSXeO, theF RNDSO haKe tN FXeSO. thXP RaP neRP XnOeeO,CNI OePUXte the OePtIDHtXNn NC a nDZAeI NC hNDPeP AF the HathNSXHAatteIXeP, the tNRn RaP HNntXnDXnJ tN IePXPt PtNDtSF RXth nN PXJn NCPDIIenOeI. HNnOe IetDIneO the HIFUtNJIaZ tN the XnhaAXtantP, anO NnPDnOaF, aUIXS 30, 1628, thNDJh XtP CNItXCXHatXNnP ReIe PtXSS DnAIeaHheOanO XtP OeCenPeP PtXSS aUUaIentSF aOeBDate CNI a SNnJ PXeJe, IeaSZNntPDOOenSF anO DneYUeHteOSF HaUXtDSateO. RXth thXP OIaZatXH PDHHePPAeJan the HaIeeI NC the Zan RhN RaP tN AeHNZe CIanHe'P CXIPt CDSS-tXZeHIFUtNSNJXPt: the JIeat antNXne INPPXJnNS.Rhen RNIO NC the XnHXOent IeaHheO HaIOXnaS IXHheSXeD, the aPtDte anOaASe JIaF eZXnenHe NC CIanHe, he at NnHe attaHheO thXP DPeCDS taSent tNhXP PDXte. INPPXJnNS UINKeO hXP RNIth aSZNPt XZZeOXateSF. the HathNSXHaIZXeP DnOeI IXHheSXeD PDIINDnOXnJ the HhXeC hDJDenNt AaPtXNn NC SaINHheSSe XnteIHeUteO PNZe SetteIP Xn HXUheI, RhXHh the FNDnJ HNOeAIeaLeINC aSAX IeaO RXth eaPe. he tNSO hXP eZXnenHe that the PtaIKXnJ HXtXMenPReIe eaJeISF aRaXtXnJ heSU that the enJSXPh haO UINZXPeO tN PenO AF Pea. Rhen the CSeetaIIXKeO, the UIXZeO JDaIOPhXUP anO CNItP PN XntXZXOateO Xt that Xt PtNNONCC the UNIt'P entIanHe anO ZaOe nN PeIXNDP atteZUt tN CNIHe a UaPPaJe. aZNnth SateI, the HXtF HaUXtDSateO Xn CDSS PXJht NC the enJSXPh KePPeSP—anOthe JIeat CIenHh tIaOXtXNn NC eYUeItXPe Xn HIFUtNSNJF haO Aeen CNDnOeO.INPPXJnNS KeIF BDXHLSF ePtaASXPheO hXZPeSC Xn the INFaS PeIKXHe. AF1630, hXP PNSDtXNnP haO ZaOe hXZ IXHh enNDJh tN ADXSO a PZaSS ADteSeJant HhateaD at EDKXPF, 12 ZXSeP PNDth NC UaIXP, SateI PDIINDnOXnJ XtRXth a HhaIZXnJ XnCNIZaS JaIOen OePXJneO AF Se nNtIe, the JaIOeneI NCKeIPaXSSeP. heIe SNDXP YXXX PtNUUeO tN KXPXt the FNDnJ HIFUt-anaSFPt Xn1634, 1635 anO 1636 Nn hXP IetDInP tN UaIXP CINZ CNntaXneASeaD.Xn the PRaPhADHLSXnJ HNDIt NC that ZNnaIHh, anO then Xn theIePUSenOent Nne NC SNDXP YXK, INPPXJnNS PeIKeO RXth an eYtIaNIOXnaIFCaHXSXtF. the PtINnJhNSO NC hePOXn PDIIenOeIeO a ReeL PNNneI than XtNtheIRXPe RNDSO haKe AeHaDPe he PNSKeO an enHXUheIeO USea CNI heSU, anOthen HNZUNPeO a IeUSF Xn the PaZe HXUheI teSSXnJ the tNRnPUeNUSe hNRCDtXSe theXI hNUeP ReIe. hNR ZanF NtheI tNRnP he HNZUeSSeO tNPDIIenOeI, hNR ZanF OXUSNZatXH HNDUP he ZaOe UNPPXASe, hNR ZanFAetIaFaSP he DnHNKeIeO aZNnJ the JIeat nNASeP Xn thNPe OaFP NC PhXCtXnJaSSeJXanHeP, he neKeI OXPHDPPeO. thXP IetXHenHe HaDPeO PNZe at the HNDIttN HhaIJe that he neKeI aHtDaSSF PNSKeO a PXnJSe HXUheI, anO that theHaIOXnaS PUIeaO XnCSateO IDZNIP aANDt hXP aAXSXtXeP tN OXPHNDIaJe RNDSO-Ae HNnPUXIatNIP. ADt Xn CaHt IXHheSXeD RaP CIeBDentSF teSSXnJ hXPPDANIOXnateP PDHh thXnJP aP,Xt XP neHePPaIF tN ZaLe DPe, Xn ZF NUXnXNn,NC the SetteIP NC the Zan RhN haP Aeen aIIePteO AF the HXKXS aDthNIXtXeP atZeMXeIeP, that XP tN PaF, haKe theZ UDt XntN INPPXJnNS'P hanOP tN Pee XCtheIe XP PNZethXnJ XZUNItant Xn theZ. NI, eXJht FeaIP SateI, Xn 1642,RIXtXnJ tN ZePPXeDIP Oe nNFeIP anO Oe HhaKXJnF:X PaR, Xn PNZeeYtIaHtP, that INPPXJnNS Pent Ze, a tIDHe neJNtXatXNn NC the LXnJ NCenJSanO RXth the UIXnHe NC NIanJe; X ON nNt thXnL that Xt Han haKe anFeCCeHt, ADt ... Xt XP DU tN FND, JentSeZen, tN LeeU FNDI eFeP UeeSeO

The frequency plots:
<p float="left">
  <img src="https://github.com/user-attachments/assets/34f01852-356e-4869-bc4c-aeb685a927f2" width="47%" />
  <img src="https://github.com/user-attachments/assets/efc1752f-eab0-4868-bce4-c21dda303ae8" width="47%" /> 
</p>

We proceeded through all 26 letters, making educated guesses based on the emerging patterns in the text and our knowledge of English language structures.
After completing all substitutions, we wrote the decrypted text to a file:

```python
write_to_file(str, "decrypted.txt")
```

This process of frequency analysis and educated guessing allowed us to break the monoalphabetic cipher without knowing the key, demonstrating the vulnerability of this encryption method to statistical analysis.
In the end we got our decrypted text:
- realmont was under siege. the royal army, under henry ii of bourbon,prince of conde, had invested it at dawn wednesday, april 19, 1628. butthe huguenots, inside the battlements of the little town in southernfrance, were putting up a stiff defense. they cannonaded conde from atower and contemptuously rejected his demands that they surrender,saying that they would die instead. conde brought up five big cannonfrom albi, a dozen miles away, and on sunday ranged them in anominous line facing realmont.that same day his soldiers captured an inhabitant of the town whowas trying to carry an enciphered message to huguenot forces outside.none of conde's men could unriddle it, but during the week the princelearned that it might be solved by the scion of a leading family of albiwho was known to have an interest in ciphers.conde sent him the cryptogram. the young man solved it on the spot.it revealed that the huguenots desperately needed munitions and that, ifthey were not supplied, they would have to yield. this was news indeed,for despite the destruction of a number of houses by the catholicbatteries, the town was continuing to resist stoutly with no sign ofsurrender. conde returned the cryptogram to the inhabitants, and onsunday, april 30, 1628, though its fortifications were still unbreachedand its defenses still apparently adequate for a long siege, realmontsuddenly and unexpectedly capitulated. with this dramatic successbegan the career of the man who was to become france's first full-timecryptologist: the great antoine rossignol.when word of the incident reached cardinal richelieu, the astute andable gray eminence of france, he at once attached this useful talent tohis suite. rossignol proved his worth almost immediately. the catholicarmies under richelieu surrounding the chief huguenot bastion of larochelle intercepted some letters in cipher, which the young codebreakerof albi read with ease. he told his eminence that the starving citizenswere eagerly awaiting help that the english had promised to send by sea. when the fleetarrived, the primed guardships and forts so intimidated it that it stoodoff the port's entrance and made no serious attempt to force a passage. amonth later, the city capitulated in full sight of the english vessels�andthe great french tradition of expertise in cryptology had been founded.rossignol very quickly established himself in the royal service. by1630, his solutions had made him rich enough to build a small butelegant chateau at juvisy, 12 miles south of paris, later surrounding itwith a charming informal garden designed by le notre, the gardener ofversailles. here louis xiii stopped to visit the young crypt-analyst in1634, 1635 and 1636 on his returns to paris from fontainebleau.in the swashbuckling court of that monarch, and then in theresplendent one of louis xiv, rossignol served with an extraordinaryfacility. the stronghold of hesdin surrendered a week sooner than itotherwise would have because he solved an enciphered plea for help, andthen composed a reply in the same cipher telling the townspeople howfutile their hopes were. how many other towns he compelled tosurrender, how many diplomatic coups he made possible, how manybetrayals he uncovered among the great nobles in those days of shiftingallegiances, he never discussed. this reticence caused some at the courtto charge that he never actually solved a single cipher, and that thecardinal spread inflated rumors about his abilities to discourage would-be conspirators. but in fact richelieu was frequently telling hissubordinates such things as,it is necessary to make use, in my opinion,of the letters of the man who has been arrested by the civil authorities atmezieres, that is to say, have them put into rossignol's hands to see ifthere is something important in them. or, eight years later, in 1642,writing to messieurs de noyers and de chavigny:i saw, in someextracts, that rossignol sent me, a truce negotiation of the king ofengland with the prince of orange; i do not think that it can have anyeffect, but ... it is up to you, gentlemen, to keep your eyes peeled



